import { getAreaMigrationsDensity } from "../../../../services/spatial-services/track-density/get-area-migrations-density";
import { areaVulnerabilityController } from "../index";
import { ServicesVulnerabilityApiTypes } from "@rrrcn/common-types/services/api/vulnerability";

export const habitatAreaOverallVulnerabilityController = async (
  request: ServicesVulnerabilityApiTypes.OverallHabitatAreaVulnerability.Body
): Promise<ServicesVulnerabilityApiTypes.OverallHabitatAreaVulnerability.Response> => {
  const birdDensitiesPerMonth = getAreaMigrationsDensity({
    //TODO change density calculation logic
    migrations: [],
    area: request.area,
    birds_count: request.birds_count as number,
  });
  const vulnerabilityResult = await areaVulnerabilityController({
    ...request,
    flightheights: [],
    birdDensitiesPerMonth,
  });

  return { birds_count: request.birds_count as number, ...vulnerabilityResult };
};
