import { MonthsKey } from "@rrrcn/admin/src/core/common/entities/vulnerability-result/counts/index";

export class CommonSpatialGridVulnerabilityCellDensitySimpleCount {
  private count: { [p in MonthsKey]: number };

  constructor(count: { [p in MonthsKey]: number }) {
    this.count = count;
  }

  getTotalCountPerMonth(): { [p in MonthsKey]: number } {
    return { ...this.count };
  }
}

export class CommonSpatialGridVulnerabilityCellDensityBreedingCount {
  private count: {
    breeding_pairs: number;
    successful_pairs: number;
    juvenils_per_pair: number;
    subadults_ratio: number;
    percent_per_month: { [p in MonthsKey]: number };
  };

  constructor(count: {
    breeding_pairs: number;
    successful_pairs: number;
    juvenils_per_pair: number;
    subadults_ratio: number;
    percent_per_month: { [p in MonthsKey]: number };
  }) {
    this.count = count;
  }

  getTotalCountPerMonth(): { [p in MonthsKey]: number } {
    const {
      breeding_pairs,
      successful_pairs,
      juvenils_per_pair,
      subadults_ratio,
      percent_per_month,
    } = this.count;
    return Object.fromEntries(
      Array(12)
        .fill(0)
        .map((_, key) => {
          const value = percent_per_month[key];
          return [
            key,
            value *
              (breeding_pairs * 2 +
                breeding_pairs * successful_pairs * juvenils_per_pair +
                breeding_pairs * subadults_ratio),
          ];
        })
    ) as { [p in MonthsKey]: number };
  }
}
